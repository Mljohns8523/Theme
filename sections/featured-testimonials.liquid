{% comment %}
  Featured Testimonials Section (Customizable Font Sizes & Styling)
  - Fully updated with:
    - Dynamic font size control (desktop/mobile) for all text elements
    - Configurable background (color/image + overlay)
    - Responsive grid and optional carousel with smooth transitions
    - Flexible card styling, gradient option, and image options
    - Clean, scalable CSS variable usage
{% endcomment %}

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

{{ 'featured-testimonials.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .testimonials__section {
    background: var(--testimonials-background-color);
    {% if section.settings.background_image %}
      background-image: linear-gradient(
        rgba(0,0,0,var(--testimonials-overlay-opacity)),
        rgba(0,0,0,var(--testimonials-overlay-opacity))
      ), var(--testimonials-background-image);
      background-size: cover;
      background-position: center;
    {% endif %}
    padding-top: var(--testimonials-padding-top);
    padding-bottom: var(--testimonials-padding-bottom);
    font-family: var(--font-heading-family);
    position: relative;
    color: #fff;
  }

.testimonials__title {
  font-size: var(--title-font-size-desktop);
  color: {{ section.settings.title_color }};
}

.testimonials__subtitle {
  font-size: var(--subtitle-font-size-desktop);
  color: {{ section.settings.subtitle_color }};
}


  
  .testimonials__grid {
    display: grid;
    grid-template-columns: repeat(var(--grid-columns), 1fr);
    gap: var(--grid-gap);
  }
  .testimonials__carousel {
    display: flex;
    overflow: hidden;
    transition: transform 0.6s ease;
  }
  .testimonials__card {
    background: var(--card-background);
    {% if section.settings.enable_card_gradient %}
      background: linear-gradient(135deg, var(--card-gradient-start), var(--card-gradient-end));
    {% endif %}
    border: var(--card-border-width) solid var(--card-border-color);
    border-radius: var(--card-border-radius);
    box-shadow: var(--card-shadow);
    padding: var(--card-padding);
    text-align: center;
    color: #1A1A1A;
  }
  .testimonials__image {
    width: var(--image-size);
    height: var(--image-size);
    object-fit: cover;
    border: var(--image-border-width) solid var(--image-border-color);
    border-radius: {% if section.settings.image_shape == 'circle' %}50%{% else %}0{% endif %};
    margin-bottom: 10px;
  }
  .testimonials__quote {
    font-size: var(--quote-font-size-desktop);
    font-weight: var(--quote-font-weight);
    color: var(--quote-color);
    margin: 10px 0;
  }
  .testimonials__author {
    font-size: var(--author-font-size-desktop);
    font-weight: var(--author-font-weight);
    color: var(--author-color);
  }

  @media (max-width: 768px) {
    .testimonials__title { font-size: var(--title-font-size-mobile); }
    .testimonials__subtitle { font-size: var(--subtitle-font-size-mobile); }
    .testimonials__quote { font-size: var(--quote-font-size-mobile); }
    .testimonials__author { font-size: var(--author-font-size-mobile); }
    .testimonials__grid { grid-template-columns: 1fr; }
  }
{%- endstyle -%}

<section class="testimonials__section"
  style="
    --testimonials-background-color: {{ section.settings.background_color }};
    --testimonials-padding-top: {{ section.settings.padding_top }}px;
    --testimonials-padding-bottom: {{ section.settings.padding_bottom }}px;
    --title-font-size-desktop: {{ section.settings.title_font_size_desktop }}px;
    --title-font-size-mobile: {{ section.settings.title_font_size_mobile }}px;
    --subtitle-font-size-desktop: {{ section.settings.subtitle_font_size_desktop }}px;
    --subtitle-font-size-mobile: {{ section.settings.subtitle_font_size_mobile }}px;
    --quote-font-size-desktop: {{ section.settings.quote_font_size_desktop }}px;
    --quote-font-size-mobile: {{ section.settings.quote_font_size_mobile }}px;
    --author-font-size-desktop: {{ section.settings.author_font_size_desktop }}px;
    --author-font-size-mobile: {{ section.settings.author_font_size_mobile }}px;
    {% if section.settings.background_image %}
      --testimonials-background-image: url('{{ section.settings.background_image | img_url: 'master' }}');
      --testimonials-overlay-opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    {% endif %}
  "
>
  <div class="testimonials__content">
    {% if section.settings.title != blank %}
      <h2 class="testimonials__title" style="text-align: {{ section.settings.title_alignment }};">
        {{ section.settings.title | escape }}
      </h2>
    {% endif %}

    {% if section.settings.subtitle != blank %}
      <p class="testimonials__subtitle" style="text-align: {{ section.settings.title_alignment }};">
        {{ section.settings.subtitle | escape }}
      </p>
    {% endif %}

    {% if section.blocks.size > 0 %}
      <div class="testimonials__grid{% if section.settings.enable_carousel %} testimonials__carousel{% endif %}"
        style="--grid-columns: {{ section.settings.grid_columns }}; --grid-gap: {{ section.settings.grid_gap }}px;
               --card-gradient-start: {{ section.settings.card_gradient_start }};
               --card-gradient-end: {{ section.settings.card_gradient_end }};">
        {% for block in section.blocks %}
          <div class="testimonials__card"
            style="
              --card-background: {{ section.settings.card_background }};
              --card-border-width: {{ section.settings.card_border_width }}px;
              --card-border-color: {{ section.settings.card_border_color }};
              --card-border-radius: {{ section.settings.card_border_radius }}px;
              --card-shadow: 0 {{ section.settings.card_shadow_intensity }}px {{ section.settings.card_shadow_intensity | times: 2 }}px rgba(0,0,0,0.1);
              --card-padding: {{ section.settings.card_padding }}px;">
            {% if block.settings.pet_image %}
              <img src="{{ block.settings.pet_image | img_url: section.settings.image_size }}"
                   alt="{{ block.settings.customer_name | escape }}'s pet"
                   class="testimonials__image"
                   style="--image-size: {{ section.settings.image_size }}px; --image-border-width: {{ section.settings.image_border_width }}px; --image-border-color: {{ section.settings.image_border_color }};"
                   loading="lazy">
            {% endif %}

            <blockquote class="testimonials__quote"
              style="--quote-font-weight: {{ section.settings.quote_font_weight }}; --quote-color: {{ section.settings.quote_color }};">
              {{ block.settings.quote | escape }}
            </blockquote>

            <cite class="testimonials__author"
              style="--author-font-weight: {{ section.settings.author_font_weight }}; --author-color: {{ section.settings.author_color }};">
              {{ block.settings.customer_name | escape }}
            </cite>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</section>

{%- javascript -%}
  document.addEventListener('DOMContentLoaded', () => {
    const carouselEnabled = {{ section.settings.enable_carousel | json }};
    if (!carouselEnabled) return;

    const carousel = document.querySelector('.testimonials__carousel');
    if (!carousel) return;

    const cards = carousel.querySelectorAll('.testimonials__card');
    let index = 0;
    const total = cards.length;
    const speed = {{ section.settings.carousel_speed | times: 1000 }};

    function slideTo(i) {
      carousel.style.transform = `translateX(-${i * 100}%)`;
    }

    setInterval(() => {
      index = (index + 1) % total;
      slideTo(index);
    }, speed);
  });
{%- endjavascript -%}

{% schema %}
{
  "name": "Featured Testimonials",
  "settings": [
    {
      "type": "header",
      "content": "Background"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#F8F8F8"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image",
      "info": "Optional. Overrides background color if set."
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Overlay Opacity",
      "min": 0,
      "max": 100,
      "step": 10,
      "default": 30,
      "unit": "%",
      "info": "Dark overlay for background image."
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding Bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Title & Subtitle"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Pet Parents Love Beast Bites"
    },
    {
      "type": "range",
      "id": "title_font_size_desktop",
      "label": "Title Font Size (Desktop)",
      "min": 10,
      "max": 48,
      "step": 1,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "title_font_size_mobile",
      "label": "Title Font Size (Mobile)",
      "min": 8,
      "max": 36,
      "step": 1,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#1A1A1A"
    },
    {
      "type": "select",
      "id": "title_alignment",
      "label": "Title Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "See why thousands trust us to fuel their pets’ energy!"
    },
    {
      "type": "range",
      "id": "subtitle_font_size_desktop",
      "label": "Subtitle Font Size (Desktop)",
      "min": 10,
      "max": 30,
      "step": 1,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "subtitle_font_size_mobile",
      "label": "Subtitle Font Size (Mobile)",
      "min": 8,
      "max": 24,
      "step": 1,
      "default": 14,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Subtitle Color",
      "default": "#333333"
    },
    {
      "type": "header",
      "content": "Grid Layout"
    },
    {
      "type": "range",
      "id": "grid_columns",
      "label": "Columns (Desktop)",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 3,
      "info": "Number of testimonial cards per row on desktop."
    },
    {
      "type": "range",
      "id": "grid_gap",
      "label": "Grid Gap",
      "min": 0,
      "max": 50,
      "step": 5,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Card Styling"
    },
    {
      "type": "checkbox",
      "id": "enable_card_gradient",
      "label": "Enable Card Gradient",
      "default": false
    },
    {
      "type": "color",
      "id": "card_gradient_start",
      "label": "Card Gradient Start",
      "default": "#ff1414"
    },
    {
      "type": "color",
      "id": "card_gradient_end",
      "label": "Card Gradient End",
      "default": "#ad0000"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Card Background",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "card_border_width",
      "label": "Card Border Width",
      "min": 0,
      "max": 5,
      "step": 1,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "card_border_color",
      "label": "Card Border Color",
      "default": "#E8ECEF"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card Border Radius",
      "min": 0,
      "max": 30,
      "step": 3,
      "default": 12,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_shadow_intensity",
      "label": "Card Shadow Intensity",
      "min": 0,
      "max": 20,
      "step": 2,
      "default": 8,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_padding",
      "label": "Card Padding",
      "min": 10,
      "max": 40,
      "step": 5,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Review Styling"
    },
    {
      "type": "range",
      "id": "quote_font_size_desktop",
      "label": "Quote Font Size (Desktop)",
      "min": 10,
      "max": 30,
      "step": 1,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "quote_font_size_mobile",
      "label": "Quote Font Size (Mobile)",
      "min": 8,
      "max": 24,
      "step": 1,
      "default": 14,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "quote_font_weight",
      "label": "Quote Font Weight",
      "options": [
        { "value": "400", "label": "Regular" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "400"
    },
    {
      "type": "color",
      "id": "quote_color",
      "label": "Quote Color",
      "default": "#1A1A1A"
    },
    {
      "type": "range",
      "id": "author_font_size_desktop",
      "label": "Author Font Size (Desktop)",
      "min": 10,
      "max": 24,
      "step": 1,
      "default": 14,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "author_font_size_mobile",
      "label": "Author Font Size (Mobile)",
      "min": 8,
      "max": 20,
      "step": 1,
      "default": 12,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "author_font_weight",
      "label": "Author Font Weight",
      "options": [
        { "value": "400", "label": "Regular" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "700"
    },
    {
      "type": "color",
      "id": "author_color",
      "label": "Author Color",
      "default": "#FF3C00"
    },
    {
      "type": "header",
      "content": "Image Styling"
    },
    {
      "type": "range",
      "id": "image_size",
      "label": "Image Size",
      "min": 50,
      "max": 150,
      "step": 10,
      "default": 100,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "image_shape",
      "label": "Image Shape",
      "options": [
        { "value": "circle", "label": "Circle" },
        { "value": "square", "label": "Square" }
      ],
      "default": "circle"
    },
    {
      "type": "range",
      "id": "image_border_width",
      "label": "Image Border Width",
      "min": 0,
      "max": 5,
      "step": 1,
      "default": 2,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "image_border_color",
      "label": "Image Border Color",
      "default": "#FF3C00"
    },
    {
      "type": "header",
      "content": "Carousel"
    },
    {
      "type": "checkbox",
      "id": "enable_carousel",
      "label": "Enable Carousel",
      "default": false
    },
    {
      "type": "range",
      "id": "carousel_speed",
      "label": "Carousel Speed",
      "min": 2,
      "max": 10,
      "step": 1,
      "default": 5,
      "unit": "s",
      "info": "Time between slides when carousel is enabled."
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "textarea",
          "id": "quote",
          "label": "Testimonial Quote",
          "default": "My dog goes wild for Beast Bites! They’re healthy and keep him energized all day."
        },
        {
          "type": "text",
          "id": "customer_name",
          "label": "Customer Name",
          "default": "Sarah & Max"
        },
        {
          "type": "image_picker",
          "id": "pet_image",
          "label": "Pet Image",
          "info": "Square image recommended. Size set in section settings."
        }
      ]
    }
  ],
  "max_blocks": 20,
  "presets": [
    {
      "name": "Featured Testimonials",
      "blocks": [
        {
          "type": "testimonial",
          "settings": {
            "quote": "My dog goes wild for Beast Bites! They’re healthy and keep him energized all day.",
            "customer_name": "Sarah & Max",
            "pet_image": null
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "quote": "The best treats we’ve tried! Grain-free and my cat loves them.",
            "customer_name": "James & Luna",
            "pet_image": null
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "quote": "Fast shipping and top-notch quality. Beast Bites is our go-to!",
            "customer_name": "Emma & Rusty",
            "pet_image": null
          }
        }
      ]
    }
  ]
}
{% endschema %}
